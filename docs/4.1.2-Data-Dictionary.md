# 4.1.2 Data Dictionary
## AI-Powered Mobile Marketplace System

---

## Table of Contents
1. [USER Table](#user-table)
2. [CUSTOMER Table](#customer-table)
3. [SELLER Table](#seller-table)
4. [PRODUCT Table](#product-table)
5. [CATEGORY Table](#category-table)
6. [ORDER Table](#order-table)
7. [ORDER_ITEM Table](#order_item-table)
8. [PAYMENT Table](#payment-table)
9. [TRANSACTION_LOG Table](#transaction_log-table)
10. [REVIEW Table](#review-table)
11. [REVIEW_SUMMARY Table](#review_summary-table)
12. [AI_RECOMMENDATION Table](#ai_recommendation-table)
13. [FRAUD_DETECTION Table](#fraud_detection-table)
14. [CHATBOT_LOG Table](#chatbot_log-table)
15. [EXTERNAL_DATA Table](#external_data-table)

---

## USER Table

**Description**: Central table storing all user accounts in the system (both customers and sellers).

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| user_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique identifier for each user |
| email | VARCHAR(255) | NOT NULL, UNIQUE | User's email address for login |
| password_hash | VARCHAR(255) | NOT NULL | Encrypted password hash |
| full_name | VARCHAR(255) | NOT NULL | User's full name |
| phone_number | VARCHAR(20) | NULL | Contact phone number |
| address | TEXT | NULL | User's physical address |
| user_type | ENUM('customer', 'seller') | NOT NULL | Discriminator for user type |
| auth_token | VARCHAR(500) | NULL | Authentication token for sessions |
| created_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | Account creation timestamp |
| updated_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP ON UPDATE | Last update timestamp |
| last_login | TIMESTAMP | NULL | Last login timestamp |
| is_verified | BOOLEAN | DEFAULT FALSE | Email verification status |

**Indexes**:
- PRIMARY KEY: user_id
- UNIQUE INDEX: email
- INDEX: user_type

---

## CUSTOMER Table

**Description**: Extended attributes specific to customer users.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| customer_id | INT | PRIMARY KEY, FOREIGN KEY(user_id) | References user_id from USER table |
| preferences | JSON | NULL | Customer preferences (AI-generated) |
| wishlist | JSON | NULL | List of product IDs in wishlist |
| loyalty_points | INT | DEFAULT 0 | Accumulated loyalty points |

**Indexes**:
- PRIMARY KEY: customer_id
- FOREIGN KEY: customer_id → USER(user_id) ON DELETE CASCADE

---

## SELLER Table

**Description**: Extended attributes specific to seller users.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| seller_id | INT | PRIMARY KEY, FOREIGN KEY(user_id) | References user_id from USER table |
| business_name | VARCHAR(255) | NOT NULL | Official business name |
| business_license | VARCHAR(100) | NULL | Business license number |
| verification_status | ENUM('pending', 'verified', 'rejected', 'suspended') | DEFAULT 'pending' | Seller verification status |
| rating | DECIMAL(3,2) | DEFAULT 0.00 | Average seller rating (0.00-5.00) |
| total_sales | DECIMAL(15,2) | DEFAULT 0.00 | Total sales amount |
| bank_account | VARCHAR(255) | NULL, ENCRYPTED | Encrypted bank account details |

**Indexes**:
- PRIMARY KEY: seller_id
- FOREIGN KEY: seller_id → USER(user_id) ON DELETE CASCADE
- INDEX: verification_status

---

## PRODUCT Table

**Description**: All products listed in the marketplace.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| product_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique product identifier |
| seller_id | INT | FOREIGN KEY, NOT NULL | References seller who listed the product |
| category_id | INT | FOREIGN KEY, NOT NULL | Product category |
| product_name | VARCHAR(255) | NOT NULL | Product name/title |
| description | TEXT | NULL | Detailed product description |
| price | DECIMAL(10,2) | NOT NULL, CHECK(price >= 0) | Product price |
| stock_quantity | INT | DEFAULT 0, CHECK(stock_quantity >= 0) | Available stock |
| ai_score | DECIMAL(5,2) | NULL | AI-generated product quality score |
| specifications | JSON | NULL | Product specifications (brand, model, etc.) |
| image_urls | JSON | NULL | Array of product image URLs |
| created_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | Product listing date |
| updated_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP ON UPDATE | Last update timestamp |
| is_active | BOOLEAN | DEFAULT TRUE | Product listing status |

**Indexes**:
- PRIMARY KEY: product_id
- FOREIGN KEY: seller_id → SELLER(seller_id) ON DELETE CASCADE
- FOREIGN KEY: category_id → CATEGORY(category_id)
- INDEX: category_id, seller_id, is_active
- FULLTEXT INDEX: product_name, description

---

## CATEGORY Table

**Description**: Product categories for organization and filtering.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| category_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique category identifier |
| category_name | VARCHAR(100) | NOT NULL, UNIQUE | Category name |
| description | TEXT | NULL | Category description |
| parent_category_id | INT | FOREIGN KEY, NULL | Self-referencing for subcategories |
| is_active | BOOLEAN | DEFAULT TRUE | Category active status |

**Indexes**:
- PRIMARY KEY: category_id
- FOREIGN KEY: parent_category_id → CATEGORY(category_id)
- UNIQUE INDEX: category_name

---

## ORDER Table

**Description**: Customer purchase orders.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| order_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique order identifier |
| customer_id | INT | FOREIGN KEY, NOT NULL | Customer who placed the order |
| seller_id | INT | FOREIGN KEY, NOT NULL | Seller fulfilling the order |
| order_date | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | Order placement timestamp |
| total_amount | DECIMAL(12,2) | NOT NULL, CHECK(total_amount >= 0) | Total order amount |
| order_status | ENUM('pending', 'confirmed', 'shipped', 'delivered', 'cancelled') | DEFAULT 'pending' | Current order status |
| shipping_address | TEXT | NOT NULL | Delivery address |
| tracking_number | VARCHAR(100) | NULL | Shipment tracking number |
| payment_status | ENUM('pending', 'completed', 'failed', 'refunded') | DEFAULT 'pending' | Payment status |

**Indexes**:
- PRIMARY KEY: order_id
- FOREIGN KEY: customer_id → CUSTOMER(customer_id)
- FOREIGN KEY: seller_id → SELLER(seller_id)
- INDEX: customer_id, seller_id, order_status, order_date

---

## ORDER_ITEM Table

**Description**: Individual products within an order (order line items).

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| order_item_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique order item identifier |
| order_id | INT | FOREIGN KEY, NOT NULL | Associated order |
| product_id | INT | FOREIGN KEY, NOT NULL | Product being ordered |
| quantity | INT | NOT NULL, CHECK(quantity > 0) | Number of units |
| unit_price | DECIMAL(10,2) | NOT NULL, CHECK(unit_price >= 0) | Price per unit at time of order |
| subtotal | DECIMAL(12,2) | NOT NULL, CHECK(subtotal >= 0) | quantity × unit_price |

**Indexes**:
- PRIMARY KEY: order_item_id
- FOREIGN KEY: order_id → ORDER(order_id) ON DELETE CASCADE
- FOREIGN KEY: product_id → PRODUCT(product_id)
- INDEX: order_id, product_id

---

## PAYMENT Table

**Description**: Payment transactions for orders.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| payment_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique payment identifier |
| order_id | INT | FOREIGN KEY, UNIQUE, NOT NULL | Associated order |
| payment_method | ENUM('card', 'wallet', 'bank_transfer', 'cod') | NOT NULL | Payment method used |
| payment_gateway_id | VARCHAR(100) | NULL | External payment gateway identifier |
| amount | DECIMAL(12,2) | NOT NULL, CHECK(amount >= 0) | Payment amount |
| payment_date | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | Payment timestamp |
| payment_status | ENUM('pending', 'processing', 'completed', 'failed', 'refunded') | DEFAULT 'pending' | Payment status |
| transaction_id | VARCHAR(255) | NULL, UNIQUE | Gateway transaction ID |
| confirmation_code | VARCHAR(100) | NULL | Payment confirmation code |

**Indexes**:
- PRIMARY KEY: payment_id
- FOREIGN KEY: order_id → ORDER(order_id)
- UNIQUE INDEX: transaction_id
- INDEX: payment_status, payment_date

---

## TRANSACTION_LOG Table

**Description**: Detailed logs of all financial transactions for audit and fraud detection.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| log_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique log identifier |
| payment_id | INT | FOREIGN KEY, NOT NULL | Associated payment |
| order_id | INT | FOREIGN KEY, NOT NULL | Associated order |
| transaction_type | ENUM('payment', 'refund', 'chargeback', 'fee') | NOT NULL | Type of transaction |
| amount | DECIMAL(12,2) | NOT NULL | Transaction amount |
| timestamp | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | Transaction timestamp |
| status | ENUM('success', 'failed', 'pending') | NOT NULL | Transaction status |
| fraud_score | DECIMAL(5,2) | NULL | AI-generated fraud risk score (0-100) |
| ip_address | VARCHAR(45) | NULL | IP address of transaction |
| device_info | JSON | NULL | Device information |

**Indexes**:
- PRIMARY KEY: log_id
- FOREIGN KEY: payment_id → PAYMENT(payment_id)
- FOREIGN KEY: order_id → ORDER(order_id)
- INDEX: timestamp, fraud_score

---

## REVIEW Table

**Description**: Customer reviews and ratings for products.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| review_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique review identifier |
| product_id | INT | FOREIGN KEY, NOT NULL | Product being reviewed |
| customer_id | INT | FOREIGN KEY, NOT NULL | Customer who wrote the review |
| rating | INT | NOT NULL, CHECK(rating BETWEEN 1 AND 5) | Star rating (1-5) |
| review_text | TEXT | NULL | Review content |
| ai_sentiment_score | DECIMAL(5,2) | NULL | AI sentiment analysis score (-1 to +1) |
| created_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | Review creation timestamp |
| is_verified | BOOLEAN | DEFAULT FALSE | Verified purchase review |

**Indexes**:
- PRIMARY KEY: review_id
- FOREIGN KEY: product_id → PRODUCT(product_id) ON DELETE CASCADE
- FOREIGN KEY: customer_id → CUSTOMER(customer_id)
- INDEX: product_id, customer_id, created_at
- FULLTEXT INDEX: review_text

---

## REVIEW_SUMMARY Table

**Description**: AI-generated summaries of product reviews.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| summary_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique summary identifier |
| product_id | INT | FOREIGN KEY, UNIQUE, NOT NULL | Product being summarized |
| ai_summary | TEXT | NULL | AI-generated review summary |
| total_reviews | INT | DEFAULT 0 | Total number of reviews |
| average_rating | DECIMAL(3,2) | DEFAULT 0.00 | Average rating (0.00-5.00) |
| sentiment_breakdown | JSON | NULL | Positive/negative/neutral percentages |
| generated_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | Summary generation timestamp |

**Indexes**:
- PRIMARY KEY: summary_id
- FOREIGN KEY: product_id → PRODUCT(product_id) ON DELETE CASCADE
- UNIQUE INDEX: product_id

---

## AI_RECOMMENDATION Table

**Description**: AI-generated product recommendations for customers.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| recommendation_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique recommendation identifier |
| customer_id | INT | FOREIGN KEY, NOT NULL | Customer receiving recommendation |
| product_id | INT | FOREIGN KEY, NOT NULL | Recommended product |
| ai_model_version | VARCHAR(50) | NULL | AI model version used |
| recommendation_score | DECIMAL(5,2) | NULL, CHECK(recommendation_score BETWEEN 0 AND 100) | Confidence score (0-100) |
| reason | TEXT | NULL | Recommendation reasoning |
| created_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | Recommendation timestamp |

**Indexes**:
- PRIMARY KEY: recommendation_id
- FOREIGN KEY: customer_id → CUSTOMER(customer_id) ON DELETE CASCADE
- FOREIGN KEY: product_id → PRODUCT(product_id) ON DELETE CASCADE
- INDEX: customer_id, recommendation_score

---

## FRAUD_DETECTION Table

**Description**: Fraud detection and seller verification records.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| fraud_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique fraud check identifier |
| seller_id | INT | FOREIGN KEY, NOT NULL | Seller being checked |
| check_type | ENUM('verification', 'periodic', 'flagged') | NOT NULL | Type of fraud check |
| fraud_score | DECIMAL(5,2) | NOT NULL, CHECK(fraud_score BETWEEN 0 AND 100) | Risk score (0-100) |
| status | ENUM('clear', 'warning', 'flagged', 'suspended') | NOT NULL | Check result status |
| checked_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | Check timestamp |
| notes | TEXT | NULL | Additional notes or findings |

**Indexes**:
- PRIMARY KEY: fraud_id
- FOREIGN KEY: seller_id → SELLER(seller_id)
- INDEX: seller_id, status, checked_at

---

## CHATBOT_LOG Table

**Description**: NLP chatbot interaction logs.

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| chat_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique chat interaction identifier |
| customer_id | INT | FOREIGN KEY, NOT NULL | Customer using chatbot |
| query | TEXT | NOT NULL | Customer's question/query |
| response | TEXT | NOT NULL | Chatbot's response |
| nlp_intent | VARCHAR(100) | NULL | Detected user intent |
| timestamp | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | Interaction timestamp |
| session_id | VARCHAR(255) | NULL | Chat session identifier |

**Indexes**:
- PRIMARY KEY: chat_id
- FOREIGN KEY: customer_id → CUSTOMER(customer_id)
- INDEX: customer_id, session_id, timestamp
- FULLTEXT INDEX: query, response

---

## EXTERNAL_DATA Table

**Description**: External data integration for products (pricing, specifications, etc.).

| Field Name | Data Type | Constraints | Description |
|------------|-----------|-------------|-------------|
| external_data_id | INT | PRIMARY KEY, AUTO_INCREMENT | Unique external data identifier |
| product_id | INT | FOREIGN KEY, NOT NULL | Associated product |
| data_source | VARCHAR(100) | NOT NULL | External data source name |
| data_type | ENUM('price', 'specs', 'availability', 'reviews') | NOT NULL | Type of external data |
| data_value | JSON | NOT NULL | External data content |
| last_updated | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP ON UPDATE | Last update timestamp |
| is_validated | BOOLEAN | DEFAULT FALSE | Data validation status |

**Indexes**:
- PRIMARY KEY: external_data_id
- FOREIGN KEY: product_id → PRODUCT(product_id) ON DELETE CASCADE
- INDEX: product_id, data_source, data_type

---

## Data Integrity Constraints

### Referential Integrity

1. **CASCADE DELETE**:
   - User deletion cascades to Customer/Seller
   - Seller deletion cascades to Products
   - Product deletion cascades to Reviews, Review Summaries
   - Order deletion cascades to Order Items

2. **RESTRICT DELETE**:
   - Cannot delete categories with active products
   - Cannot delete products with pending orders

### Business Rules

1. **Order Total Validation**:
   ```sql
   ORDER.total_amount = SUM(ORDER_ITEM.subtotal) + shipping_fee
   ```

2. **Stock Validation**:
   ```sql
   ORDER_ITEM.quantity <= PRODUCT.stock_quantity
   ```

3. **Review Eligibility**:
   - Customer can only review products they've purchased
   - One review per customer per product

4. **Fraud Score Thresholds**:
   - 0-30: Clear
   - 31-60: Warning
   - 61-80: Flagged
   - 81-100: Suspended

---

## Data Types Legend

| Data Type | Description | Example |
|-----------|-------------|---------|
| INT | Integer number | 1, 100, -5 |
| VARCHAR(n) | Variable character string (max n chars) | "John Doe" |
| TEXT | Long text | Product description |
| DECIMAL(p,s) | Fixed-point number (p digits, s decimals) | 99.99 |
| TIMESTAMP | Date and time | 2024-12-09 10:30:00 |
| BOOLEAN | True/False value | TRUE, FALSE |
| JSON | JSON formatted data | {"key": "value"} |
| ENUM | Predefined list of values | 'pending', 'completed' |

---

## Security Considerations

1. **Encrypted Fields**: password_hash, bank_account
2. **Hashed Fields**: auth_token
3. **PII Protection**: email, phone_number, address
4. **Audit Trail**: created_at, updated_at, timestamp fields
5. **Soft Deletes**: is_active flags for logical deletion

---

*This data dictionary provides comprehensive documentation for all database entities in the AI-Powered Mobile Marketplace system.*
